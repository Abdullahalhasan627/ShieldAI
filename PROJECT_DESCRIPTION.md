# ShieldAI - ููุงูุญ ุงูููุฑูุณุงุช ุงูุฐูู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู

## ูุธุฑุฉ ุนุงูุฉ

**ShieldAI** ูู ุญู ูุชูุงูู ูููุงูุญุฉ ุงูููุฑูุณุงุช ูุจูู ุจู **.NET 8** ู **C#**ุ ูุฌูุน ุจูู ุชูููุงุช ุงููุดู ุงูุชูููุฏูุฉ (ุงูุชูููุนุงุช + ุงูุชุญููู ุงูุณูููู) ูุงูุฐูุงุก ุงูุงุตุทูุงุนู (ML.NET) ูุชูููุฑ ุญูุงูุฉ ุดุงููุฉ ุถุฏ ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ.

### ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

- **ูุดู ูุชุนุฏุฏ ุงููุญุฑูุงุช**: 4 ูุญุฑูุงุช (ุชูููุนุงุชุ ุชุญููู ุณููููุ ุชุนูู ุขููุ ุณูุนุฉ) ูุน ุชุฌููุน ูุฑุฌูุญ ูููุชุงุฆุฌ
- **ุญูุงูุฉ ููุฑูุฉ**: ูุฑุงูุจุฉ ูุธุงู ุงููููุงุช ูู ุงูููุช ุงูุญูููู ูุน Pipeline ูุชูุฏู
- **ุชุญููู PE ูุชูุฏู**: ูุญุต ูููุงุช Windows ุงูุชูููุฐูุฉ (imports, entropy, sections, signatures)
- **ุชุนูู ุขูู**: ุชุตููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ ุจุงุณุชุฎุฏุงู ML.NET FastTree
- **ุญุฌุฑ ุตุญู ุขูู**: ุชุดููุฑ AES ูุญูู ุจู DPAPI ูุน ุงูุชุญูู ูู ุณูุงูุฉ ุงููููุงุช
- **ุฎุฏูุฉ Windows**: ุชุนูู ูู ุงูุฎูููุฉ ูุน IPC ุนุจุฑ Named Pipes
- **ูุงุฌูุฉ ูุณุชุฎุฏู ุญุฏูุซุฉ**: WPF ุจููุท MVVM ูุน ุชุตููู Dark Mode ุนุตุฑู

---

## ุงูุจููุฉ ุงููุนูุงุฑูุฉ

```
ShieldAI.sln
โโโ ShieldAI.Core          โ ุงูููุชุจุฉ ุงูุฃุณุงุณูุฉ (ููุทู ุงููุดู ูุงููุญุต)
โโโ ShieldAI.Service       โ ุฎุฏูุฉ Windows (ุชุนูู ูู ุงูุฎูููุฉ)
โโโ ShieldAI.UI            โ ูุงุฌูุฉ ุงููุณุชุฎุฏู WPF
โโโ ShieldAI.Tests         โ ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ (xUnit)
```

### ุงูุชูููุงุช ุงููุณุชุฎุฏูุฉ

| ุงูุชูููุฉ | ุงูุงุณุชุฎุฏุงู |
|---------|-----------|
| .NET 8 | ุงูุฅุทุงุฑ ุงูุฃุณุงุณู |
| WPF | ูุงุฌูุฉ ุงููุณุชุฎุฏู |
| ML.NET + FastTree | ุชุตููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ |
| CommunityToolkit.Mvvm | ููุท MVVM |
| Named Pipes | IPC ุจูู ุงูุฎุฏูุฉ ูุงููุงุฌูุฉ |
| DPAPI + AES | ุชุดููุฑ ุงูุญุฌุฑ ุงูุตุญู |
| System.Threading.Channels | Pipeline ุงููุฑุงูุจุฉ ุงูููุฑูุฉ |
| xUnit | ุงูุงุฎุชุจุงุฑุงุช |

---

## ูููู ุงููุดุฑูุน ุงูุชูุตููู

### 1. ShieldAI.Core โ ุงูููุชุจุฉ ุงูุฃุณุงุณูุฉ

ุงูููุชุจุฉ ุงููุฑูุฒูุฉ ุงูุชู ุชุญุชูู ุนูู ูู ููุทู ุงููุดู ูุงููุญุต ูุงููุฑุงูุจุฉ.

#### Configuration/ โ ุงูุฅุนุฏุงุฏุงุช
| ุงูููู | ุงููุตู |
|-------|-------|
| `AppSettings.cs` | ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู: ูุณุงุฑุงุชุ ุฎูุงุฑุงุช ุงููุญุตุ ุฃูุฒุงู ุงููุญุฑูุงุชุ ุฅุนุฏุงุฏุงุช Pipelineุ VirusTotalุ ML |
| `ConfigManager.cs` | Singleton ูุฅุฏุงุฑุฉ ุชุญููู/ุญูุธ ุงูุฅุนุฏุงุฏุงุช ูู JSON |
| `ScanProfile.cs` | ูููุงุช ุชุนุฑูู ุงููุญุต (ุณุฑูุนุ ูุงููุ ูุฎุตุต) |

#### Detection/ โ ูุญุฑูุงุช ุงููุดู
| ุงูููู | ุงููุตู |
|-------|-------|
| `SignatureDatabase.cs` | ูุงุนุฏุฉ ุจูุงูุงุช ุงูุชูููุนุงุช (MD5, SHA256) ูุน ุชุญููู/ุญูุธ ูุจุญุซ |
| `HeuristicAnalyzer.cs` | ุงูุชุญููู ุงูุณูููู ุงูุฃุณุงุณู (APIs ุฎุทูุฑุฉุ entropyุ sections ูุดุจููุฉ) |
| `DefenderScanner.cs` | ุชูุงูู ูุน Windows Defender ูุฑุฃู ุซุงูู |
| `VirusTotalClient.cs` | ุนููู VirusTotal API ูููุญุต ุงูุณุญุงุจู |

#### Detection/ThreatScoring/ โ ูุธุงู ุงูุชูููู ุงููุชุนุฏุฏ โญ ุฌุฏูุฏ
| ุงูููู | ุงููุตู |
|-------|-------|
| `IThreatEngine.cs` | ูุงุฌูุฉ ููุญุฏุฉ ูุฌููุน ูุญุฑูุงุช ุงููุดู |
| `ThreatScanContext.cs` | ุณูุงู ุงููุญุต (ูุนูููุงุช ุงููููุ PEุ hashes) |
| `ThreatScanResult.cs` | ูุชุงุฆุฌ ุงููุญุฑูุงุช + ุงููุชูุฌุฉ ุงููุฌููุนุฉ + Enums (EngineVerdict, AggregatedVerdict) |
| `SignatureEngine.cs` | ูุญุฑู ุงูุชูููุนุงุช โ ูุบููู SignatureDatabase |
| `HeuristicEngine.cs` | ูุญุฑู ุงูุชุญููู ุงูุณูููู ุงููุชูุฏู โ ูุญุต PE ุดุงูู (imports ูุดุจููุฉุ entropy ุนุงููุ packingุ sections ุบูุฑ ุทุจูุนูุฉุ ูุณุงุฑุงุช ูุดุจููุฉุ ุชูููุน ุฑููู) |
| `MlEngine.cs` | ูุญุฑู ุงูุชุนูู ุงูุขูู โ ูุบููู MalwareClassifier ูุน ุดุฑุญ ุงูุฃุณุจุงุจ |
| `ReputationEngine.cs` | ูุญุฑู ุงูุณูุนุฉ โ ุชูููู ุงููุงุดุฑ ูุงููุณุงุฑ ูุงูุงูุชุฏุงุฏ ูุงูุนูุฑ |
| `ThreatAggregator.cs` | ุงููุฌููุน ุงูุฑุฆูุณู โ ูุดุบูู ุฌููุน ุงููุญุฑูุงุช ุจุงูุชูุงุฒูุ ูุญุณุจ ุงููุชูุฌุฉ ุงููุฑุฌูุญุฉ (0-100)ุ ููุญุฏุฏ ุงููุฑุงุฑ ุงูููุงุฆู (Allow/Quarantine/Block/NeedsReview) |

#### ML/ โ ุงูุชุนูู ุงูุขูู
| ุงูููู | ุงููุตู |
|-------|-------|
| `MalwareFeatures.cs` | ูููุฐุฌ ุงูุจูุงูุงุช ูู ML.NET (10 ุฎุตุงุฆุต ุฑูููุฉ) |
| `FeatureExtractor.cs` | ุงุณุชุฎุฑุงุฌ ุงูุฎุตุงุฆุต ูู ูููุงุช PE + ุญุณุงุจ ุฏุฑุฌุฉ ุงูุฎุทูุฑุฉ ุจุงูููุงุนุฏ |
| `MalwareClassifier.cs` | ูุตููู ML.NET FastTree โ ุชุฏุฑูุจุ ุชุญูููุ ุชูุจุค |
| `ModelTrainer.cs` | ุชุฏุฑูุจ ุงููููุฐุฌ ูุน ุจูุงูุงุช ุชุฏุฑูุจูุฉ |
| `DeepAnalyzer.cs` | ุชุญููู ุนููู ุดุงูู (PE + Heuristic + ML + VirusTotal + Defender) |

#### Scanning/ โ ุงููุญุต
| ุงูููู | ุงููุตู |
|-------|-------|
| `FileScanner.cs` | ูุญุต ุงููููุงุช ุงููุฑุฏูุฉ (signatures + heuristic) |
| `ProcessScanner.cs` | ูุญุต ุงูุนูููุงุช ุงูุฌุงุฑูุฉ ูู ุงูุฐุงูุฑุฉ |
| `PEAnalyzer.cs` | ุชุญููู ูููุงุช PE (headers, sections, imports, entropy, signature) |
| `FileEnumerator.cs` | ุชุนุฏุงุฏ ุงููููุงุช ูุน ููุชุฑุฉ ุงูุงูุชุฏุงุฏุงุช ูุงููุฌูุฏุงุช ุงููุณุชุซูุงุฉ |
| `ScanOrchestrator.cs` | ููุณู ุงููุญุต โ ุฅุฏุงุฑุฉ Queue + Parallelism + Progress + Events |
| `StreamingHasher.cs` | ุญุณุงุจ MD5/SHA256 ุจุงูุชุฏูู (streaming) ูููููุงุช ุงููุจูุฑุฉ |

#### Monitoring/ โ ุงููุฑุงูุจุฉ ุงูููุฑูุฉ
| ุงูููู | ุงููุตู |
|-------|-------|
| `RealTimeMonitor.cs` | ูุฑุงูุจ FileSystemWatcher ูุน Debounce |
| `FileEventDebouncer.cs` | ููุน ุงููุญุต ุงููุชูุฑุฑ ููููู ููุณู |
| `QuarantineManager.cs` | ูุฏูุฑ ุงูุญุฌุฑ ุงูุฃุณุงุณู (ููู + ุชุดููุฑ ุจุณูุท + manifest) |

#### Monitoring/Pipeline/ โ Pipeline ุงููุฑุงูุจุฉ ุงููุชูุฏู โญ ุฌุฏูุฏ
| ุงูููู | ุงููุตู |
|-------|-------|
| `FileEventQueue.cs` | ุทุงุจูุฑ ุฃุญุฏุงุซ ุงููููุงุช ุจุงุณุชุฎุฏุงู System.Threading.Channels (bounded) |
| `EventCoalescer.cs` | ุชุฌููุน ุงูุฃุญุฏุงุซ ุงููุชูุฑุฑุฉ (debounce 300-800ms ูุงุจู ููุชุนุฏูู) ูุน ููุน ุงูุญููุงุช |
| `ScanWorker.cs` | ุนุงูู ูุญุต ูุชุนุฏุฏ โ ูุณุชููู ูู ุงูุทุงุจูุฑ ูููุญุต ุนุจุฑ ThreatAggregator ูุน ุญุฌุฑ ุชููุงุฆู |

#### Monitoring/Quarantine/ โ ุงูุญุฌุฑ ุงูุขูู โญ ุฌุฏูุฏ
| ุงูููู | ุงููุตู |
|-------|-------|
| `QuarantineCrypto.cs` | ุชุดููุฑ AES-256 ูุน ุญูุงูุฉ ุงูููุชุงุญ ุจู DPAPI + HMAC ููุชุญูู ูู ุงูุณูุงูุฉ |
| `QuarantineItemMetadata.cs` | ุจูุงูุงุช ูุตููุฉ ุดุงููุฉ (ุงููุณุงุฑ ุงูุฃุตููุ SHA256ุ ุงููุฑุงุฑุ ุงูุฃุณุจุงุจุ ูุชุงุฆุฌ ุงููุญุฑูุงุช) |
| `QuarantineStore.cs` | ูุฎุฒู ุงูุญุฌุฑ ุงููุงูู โ ุชุดููุฑุ ูู ุชุดููุฑุ ุงุณุชุนุงุฏุฉ ูุน ุงูุชุญูู ูู Hashุ ุญุฐูุ ุชูุธูู |

#### Models/ โ ุงูููุงุฐุฌ
| ุงูููู | ุงููุตู |
|-------|-------|
| `DataModels.cs` | ThreatInfo, ThreatType, LegacyScanResult, ProcessInfo, PEFileInfo |
| `ScanModels.cs` | ScanType, ScanStatus, ScanVerdict, ThreatLevel, ScanJob, ScanResult, ScanReport, Events |

#### Contracts/ โ ุนููุฏ IPC
| ุงูููู | ุงููุตู |
|-------|-------|
| `IpcContracts.cs` | CommandEnvelope, ResponseEnvelope, EventEnvelope, ุฌููุน DTOs ููุงุชุตุงู ุจูู ุงูุฎุฏูุฉ ูุงููุงุฌูุฉ |

#### Logging/ โ ุงูุชุณุฌูู
| ุงูููู | ุงููุตู |
|-------|-------|
| `ILogger.cs` | ูุงุฌูุฉ ุงูุชุณุฌูู ุงููุฎุตุตุฉ |
| `LogEvent.cs` | ูููุฐุฌ ุญุฏุซ ุงูุณุฌู |
| `FileLogger.cs` | ุชุณุฌูู ูู ูููุงุช ูุน rotation |

---

### 2. ShieldAI.Service โ ุฎุฏูุฉ Windows

ุฎุฏูุฉ ุชุนูู ูู ุงูุฎูููุฉ ูู Windows Service ุชุฏูุฑ ุฌููุน ุนูููุงุช ุงูุญูุงูุฉ.

| ุงูููู | ุงููุตู |
|-------|-------|
| `Program.cs` | ููุทุฉ ุงูุฏุฎูู โ ุฅุนุฏุงุฏ Hostุ ุชุณุฌูู ุงูุฎุฏูุงุชุ ุฅุนุฏุงุฏ Logging |
| `ScanScheduler.cs` | ุฌุฏููุฉ ุงููุญูุตุงุช ุงูุฏูุฑูุฉ |

#### Workers/
| ุงูููู | ุงููุตู |
|-------|-------|
| `ShieldAIWorker.cs` | ุงูุนุงูู ุงูุฑุฆูุณู โ ูููุฆ ScanOrchestrator + RealTimeMonitor + QuarantineManager |
| `IpcServerWorker.cs` | ุฎุงุฏู IPC โ ูุณุชูุจู ุฃูุงูุฑ UI ุนุจุฑ Named Pipes ููุนุงูุฌูุง |
| `RealtimeWorker.cs` | โญ ุนุงูู ุงููุฑุงูุจุฉ ุงูููุฑูุฉ โ ูุณุชุฎุฏู Pipeline ุงูุฌุฏูุฏ (FileEventQueue + EventCoalescer + PipelineScanWorker) |
| `ScanWorkerService.cs` | โญ ุนุงูู ุงููุญุต โ ูุฏูุฑ ุงููุญูุตุงุช ุงููุฌุฏููุฉ ูุงููุฎุตุตุฉ ูุน ThreatAggregator |

#### Ipc/ โญ ุฌุฏูุฏ
| ุงูููู | ุงููุตู |
|-------|-------|
| `PipeContracts.cs` | DTOs ูุญุณููุฉ ููุงุชุตุงู v2 |
| `PipeServer.cs` | ุฎุงุฏู Named Pipes ูุน ุฏุนู ุงูุจุซ (broadcast) ููุฃุญุฏุงุซ |

---

### 3. ShieldAI.UI โ ูุงุฌูุฉ ุงููุณุชุฎุฏู

ุชุทุจูู WPF ุจุชุตููู ุญุฏูุซ (Dark Mode) ูุชูุงุตู ูุน ุงูุฎุฏูุฉ ุนุจุฑ Named Pipes.

#### ุงููููุงุช ุงูุฑุฆูุณูุฉ
| ุงูููู | ุงููุตู |
|-------|-------|
| `App.xaml` | ููุงุฑุฏ ุงูุชุทุจูู ูุงููุญููุงุช |
| `MainWindow.xaml` | ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ โ ุดุฑูุท ุนููุงู ูุฎุตุต + ูุงุฆูุฉ ุฌุงูุจูุฉ + ููุทูุฉ ุงููุญุชูู |

#### Styles/
| ุงูููู | ุงููุตู |
|-------|-------|
| `ModernStyles.xaml` | ุฌููุน ุงูุฃููุงุท: ุฃููุงูุ ุฎุทูุทุ ุฃุฒุฑุงุฑุ ุจุทุงูุงุชุ ููุงุฆูุ ูุฑุจุนุงุช ูุตุ Toggle |

#### Converters/
| ุงูููู | ุงููุตู |
|-------|-------|
| `Converters.cs` | BoolToVisibility, InverseBoolToVisibility, FileSizeConverter, RiskToColorConverter, IndexToBoolConverter |

#### Services/
| ุงูููู | ุงููุตู |
|-------|-------|
| `ShieldServiceClient.cs` | ุนููู IPC ูุงูู โ ูุชูุงุตู ูุน ุงูุฎุฏูุฉ ุนุจุฑ IpcContracts |
| `IpcClient.cs` | ุนููู IPC ุจุณูุท ูุน ุฃูุงูุฑ ูุฎุชุตุฑุฉ |
| `PipeClient.cs` | โญ ุนููู Named Pipes v2 ูุน ุฏุนู ุงูุฃุญุฏุงุซ |
| `NavigationService.cs` | ุฅุฏุงุฑุฉ ุงูุชููู ุจูู ุงูุตูุญุงุช |
| `DialogService.cs` | ุฎุฏูุฉ ุงูุญูุงุฑุงุช (ุฑุณุงุฆูุ ุงุฎุชูุงุฑ ูููุงุช) |
| `DispatcherService.cs` | ุชูููุฐ ุนูู UI Thread |

#### Models/
| ุงูููู | ุงููุตู |
|-------|-------|
| `ThreatRecord.cs` | โญ ููุงุฐุฌ ุตูุญุฉ ุงูุชุงุฑูุฎ: ThreatRecord (ุณุฌู ุชูุฏูุฏ)ุ EngineResultItem (ูุชูุฌุฉ ูุญุฑู)ุ ScanSession (ุฌูุณุฉ ูุญุต) |

#### ViewModels/ (MVVM)
| ุงูููู | ุงููุตู |
|-------|-------|
| `MainViewModel.cs` | ViewModel ุงูุฑุฆูุณู โ ุฅุฏุงุฑุฉ ุงููุญุต ูุงููุฑุงูุจุฉ ูุงูุญุฌุฑ |
| `DashboardViewModel.cs` | ููุญุฉ ุงูููุงุฏุฉ โ ุฅุญุตุงุฆูุงุช ูุญุงูุฉ ุงูุญูุงูุฉ |
| `ScanViewModel.cs` | ุตูุญุฉ ุงููุญุต โ ุจุฏุก/ุฅููุงู/ุชูุฏู |
| `AIScanViewModel.cs` | ุตูุญุฉ ุงููุญุต ุงูุนููู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู |
| `ProcessesViewModel.cs` | ุตูุญุฉ ุงูุนูููุงุช ุงูุฌุงุฑูุฉ |
| `QuarantineViewModel.cs` | ุตูุญุฉ ุงูุญุฌุฑ ุงูุตุญู โ ุนุฑุถ/ุงุณุชุนุงุฏุฉ/ุญุฐู |
| `HistoryViewModel.cs` | โญ ุตูุญุฉ ุณุฌู ุงูุชูุฏูุฏุงุช โ ุนุฑุถ ูุน ููุชุฑุฉ ุจุงููุฑุงุฑ/ุงููุญุฑู/ุงูุชุงุฑูุฎ |
| `SettingsViewModel.cs` | ุตูุญุฉ ุงูุฅุนุฏุงุฏุงุช |
| `LogsViewModel.cs` | ุตูุญุฉ ุงูุณุฌูุงุช |

#### Views/ (XAML)
| ุงูููู | ุงููุตู |
|-------|-------|
| `DashboardView.xaml` | ๐ ููุญุฉ ุงูููุงุฏุฉ |
| `ScanView.xaml` | ๐ ูุญุต ุงููููุงุช |
| `AIScanView.xaml` | ๐ค ุงููุญุต ุงูุนููู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู |
| `ProcessesView.xaml` | โ๏ธ ุงูุนูููุงุช ุงูุฌุงุฑูุฉ |
| `QuarantineView.xaml` | ๐ ุงูุญุฌุฑ ุงูุตุญู |
| `HistoryView.xaml` | โญ ๐ ุณุฌู ุงูุชูุฏูุฏุงุช โ ุฌุฏูู ูุน ุฏุฑุฌุฉ ุฎุทูุฑุฉ ููููุฉ + ุชูุงุตูู ุงููุญุฑูุงุช |
| `SettingsView.xaml` | โก ุงูุฅุนุฏุงุฏุงุช |
| `LogsView.xaml` | ๐ ุงูุณุฌูุงุช |

---

### 4. ShieldAI.Tests โ ุงูุงุฎุชุจุงุฑุงุช

101 ุงุฎุชุจุงุฑ ูุญุฏุฉ ุจุงุณุชุฎุฏุงู xUnit.

| ุงูููู | ุนุฏุฏ ุงูุงุฎุชุจุงุฑุงุช | ุงููุตู |
|-------|---------------|-------|
| `ThreatAggregatorTests.cs` | 17 โญ | ุงูุชูููู ุงููุฑุฌูุญุ ุงููุฑุงุฑุงุชุ ุงูุฃูุฒุงู ุงููุฎุตุตุฉุ ุงูุญุฏูุฏุ ุงูุชูุงูู |
| `QuarantineStoreTests.cs` | 14 โญ | ุชุดููุฑ/ูู ุชุดููุฑ roundtrip (ูุตุ ุซูุงุฆูุ ูุจูุฑ)ุ metadataุ hashุ ุญุฐู |
| `EventCoalescerTests.cs` | 9 โญ | debounceุ ูููุงุช ูุชุนุฏุฏุฉุ ูููุงุช ุบูุฑ ููุฌูุฏุฉุ ุงูุทุงุจูุฑ |
| `FeatureExtractionTests.cs` | 8 โญ | ุงุณุชูุฑุงุฑ ุงูุงุณุชุฎุฑุงุฌุ ุชุนููู ุงูุญูููุ ุฏุฑุฌุฉ ุงูุฎุทูุฑุฉุ ุญุงูุงุช ุญุฏูุฉ |
| `QuarantineManagerTests.cs` | 8 | ุงูุญุฌุฑ ุงูุฃุณุงุณู (ูููุ manifestุ ุงุณุชุนุงุฏุฉุ ุญุฐู) |
| `ConfigAndLoggingTests.cs` | 10 | ุงูุฅุนุฏุงุฏุงุชุ ConfigManagerุ FileLoggerุ LogEvent |
| `StreamingHasherTests.cs` | 7 | SHA256ุ MD5ุ ูููุงุช ูุจูุฑุฉุ ูููุงุช ูุงุฑุบุฉ |
| `FileEnumeratorTests.cs` | 7 | ุชุนุฏุงุฏ ุงููููุงุชุ ููุชุฑุฉุ recursive |
| `RealTimeMonitorTests.cs` | 5 | ุฅูุดุงุกุ ุจุฏุก/ุฅููุงูุ dispose |
| `PEAnalyzerTests.cs` | 4 | ุชุญููู PE ุตุงูุญุ ููู ูุตูุ ููู ุบูุฑ ููุฌูุฏ |
| `ScannerTests.cs` | 3 | ุฅูุดุงุก FileScannerุ ูุญุต ูููุ ูุญุต ูุฌูุฏ |
| `MLTests.cs` | 4 | ุฅูุดุงุก MalwareClassifierุ ุชูุจุคุ ModelTrainer |

---

## ุชุฏูู ุงูุนูู (Architecture Flow)

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ShieldAI.UI (WPF)                     โ
โ  โโโโโโโโโโโโ โโโโโโโโโโโโ โโโโโโโโโโโโ โโโโโโโโโโโโโโ  โ
โ  โDashboard โ โ  Scan    โ โQuarantineโ โ  History   โ  โ
โ  โโโโโโฌโโโโโโ โโโโโโฌโโโโโโ โโโโโโฌโโโโโโ โโโโโโโฌโโโโโโโ  โ
โ       โโโโโโโโโโโโโโโดโโโโโโโโโโโโโดโโโโโโโโโโโโโโ         โ
โ                         โ IPC (Named Pipes)              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              ShieldAI.Service (Windows Service)           โ
โ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโ  โ
โ  โIpcServerWorkerโ  โRealtimeWorkerโ  โScanWorkerSvc  โ  โ
โ  โโโโโโโโฌโโโโโโโโ  โโโโโโโโฌโโโโโโโโ  โโโโโโโโโฌโโโโโโโโ  โ
โ         โ                 โ                   โ          โ
โโโโโโโโโโโผโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโ
          โ                 โ                   โ
โโโโโโโโโโโผโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโ
โ         โ        ShieldAI.Core                โ          โ
โ         โผ                 โผ                   โผ          โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โ  โ              ThreatAggregator                    โ     โ
โ  โ  โโโโโโโโโโโโ โโโโโโโโโโโโ โโโโโโ โโโโโโโโโโโโ โ     โ
โ  โ  โSignature โ โHeuristic โ โ ML โ โReputationโ โ     โ
โ  โ  โ Engine   โ โ Engine   โ โEng.โ โ Engine   โ โ     โ
โ  โ  โโโโโโโโโโโโ โโโโโโโโโโโโ โโโโโโ โโโโโโโโโโโโ โ     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โ                         โ                                โ
โ              โโโโโโโโโโโโผโโโโโโโโโโโ                     โ
โ              โ  AggregatedResult   โ                     โ
โ              โ  Score: 0-100       โ                     โ
โ              โ  Verdict: Allow /   โ                     โ
โ              โ  Quarantine / Block โ                     โ
โ              โ  / NeedsReview      โ                     โ
โ              โโโโโโโโโโโโฌโโโโโโโโโโโ                     โ
โ                         โ                                โ
โ              โโโโโโโโโโโโผโโโโโโโโโโโ                     โ
โ              โ   QuarantineStore   โ                     โ
โ              โ   (DPAPI + AES)     โ                     โ
โ              โโโโโโโโโโโโโโโโโโโโโโโ                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ุชุฏูู ุงููุฑุงูุจุฉ ุงูููุฑูุฉ (Pipeline)

```
FileSystemWatcher โ EventCoalescer (debounce) โ FileEventQueue (Channel)
    โ PipelineScanWorker(s) โ ThreatAggregator โ QuarantineStore (ุฅุฐุง ุฎุทูุฑ)
```

### ุชุฏูู ุงููุญุต ุงููุฏูู

```
UI โ IPC Command โ ScanWorkerService โ ScanOrchestrator
    โ FileEnumerator โ [Parallel] ScanFile โ ThreatAggregator โ Results โ UI
```

---

## ูุธุงู ุงูุชูููู ุงููุชุนุฏุฏ ุงููุญุฑูุงุช

### ุงููุญุฑูุงุช ุงูุฃุฑุจุนุฉ

| ุงููุญุฑู | ุงููุฒู ุงูุงูุชุฑุงุถู | ุงููุธููุฉ |
|--------|----------------|---------|
| **SignatureEngine** | 0.35 | ูุทุงุจูุฉ MD5/SHA256 ูุน ูุงุนุฏุฉ ุงูุชูููุนุงุช |
| **HeuristicEngine** | 0.30 | ุชุญููู PE: imports ุฎุทูุฑุฉุ entropy ุนุงููุ packingุ sections ุบูุฑ ุทุจูุนูุฉุ ูุณุงุฑุงุช ูุดุจููุฉ |
| **MlEngine** | 0.20 | ุชุตููู ML.NET FastTree ูุน ุงุณุชุฎุฑุงุฌ 10 ุฎุตุงุฆุต |
| **ReputationEngine** | 0.15 | ุชูููู ุงููุงุดุฑุ ุงููุณุงุฑุ ุงูุงูุชุฏุงุฏุ ุงูุนูุฑ |

### ุญุณุงุจ ุงููุชูุฌุฉ

```
WeightedScore = ฮฃ(EngineScore ร Weight ร Confidence) / ฮฃ(Weight ร Confidence)
```

### ุงููุฑุงุฑุงุช (Thresholds)

| ุงููุฑุงุฑ | ุงูุญุฏ ุงูุฃุฏูู | ุงููุตู |
|--------|------------|-------|
| **Block** | โฅ 80 | ุญุธุฑ ููุฑู โ ุชูุฏูุฏ ูุคูุฏ |
| **Quarantine** | โฅ 55 | ููู ููุญุฌุฑ โ ูุดุจูู ุฌุฏุงู |
| **NeedsReview** | โฅ 30 | ูุญุชุงุฌ ูุฑุงุฌุนุฉ ูุฏููุฉ |
| **Allow** | < 30 | ุขูู โ ุงูุณูุงุญ |

> ููุงุญุธุฉ: ุฅุฐุง ุฃุนุทู ุฃู ูุญุฑู `Malicious` ุจุซูุฉ โฅ 0.9 โ ูุชู ุงูุญุธุฑ ูุจุงุดุฑุฉ ุจุบุถ ุงููุธุฑ ุนู ุงููุชูุฌุฉ.

---

## ุงูุญุฌุฑ ุงูุตุญู ุงูุขูู

### ุขููุฉ ุงูุชุดููุฑ

1. **ุชูููุฏ ููุชุงุญ AES-256** ุนุดูุงุฆู ููู ููู
2. **ุญูุงูุฉ ุงูููุชุงุญ ุจู DPAPI** (ูุฑุชุจุท ุจุงููุณุชุฎุฏู/ุงูุฌูุงุฒ)
3. **ุชุดููุฑ ุงูููู** ุจุงุณุชุฎุฏุงู AES-CBC ูุน IV ุนุดูุงุฆู
4. **ุญุณุงุจ HMAC-SHA256** ููุชุญูู ูู ุณูุงูุฉ ุงูุจูุงูุงุช ุงููุดูุฑุฉ
5. **ุญูุธ metadata** ูู JSON (ุงููุณุงุฑ ุงูุฃุตููุ SHA256ุ ุงููุฑุงุฑุ ุงูุฃุณุจุงุจุ ูุชุงุฆุฌ ุงููุญุฑูุงุช)

### ุขููุฉ ุงูุงุณุชุนุงุฏุฉ

1. **ูุฑุงุกุฉ metadata** ูุงูุชุญูู ูู ูุฌูุฏ ุงูููู ุงููุดูุฑ
2. **ูู ุญูุงูุฉ ุงูููุชุงุญ** ุนุจุฑ DPAPI
3. **ุงูุชุญูู ูู HMAC** ูุจู ูู ุงูุชุดููุฑ
4. **ูู ุชุดููุฑ AES** ูุงุณุชุนุงุฏุฉ ุงููุญุชูู ุงูุฃุตูู
5. **ุงูุชุญูู ูู SHA256** ููููู ุงููุณุชุนุงุฏ ููุงุจู ุงููููุฉ ุงููุญููุธุฉ

---

## IPC โ ุงูุงุชุตุงู ุจูู ุงูุฎุฏูุฉ ูุงููุงุฌูุฉ

### ุงูุจุฑูุชูููู

- **ุงูููู**: Named Pipes (`ShieldAI_IPC`)
- **ุงูุชูุณูู**: JSON ูุน length-prefix (4 bytes)
- **ุงูุงุชุฌุงู**: ุซูุงุฆู (request/response + server push events)

### ุงูุฃูุงูุฑ ุงููุฏุนููุฉ

| ุงูุฃูุฑ | ุงููุตู |
|-------|-------|
| `Ping` | ุงุฎุชุจุงุฑ ุงูุงุชุตุงู |
| `GetStatus` | ุญุงูุฉ ุงูุฎุฏูุฉ (ุชุดุบููุ ุญูุงูุฉ ููุฑูุฉุ ุฅุญุตุงุฆูุงุช) |
| `StartScan` | ุจุฏุก ูุญุต (ูุณุงุฑุงุชุ ููุนุ ุฎูุงุฑุงุช) |
| `StopScan` | ุฅููุงู ูุญุต ุฌุงุฑู |
| `GetScanProgress` | ุชูุฏู ุงููุญุต ุงูุญุงูู |
| `EnableRealTime` | ุชูุนูู ุงูุญูุงูุฉ ุงูููุฑูุฉ |
| `DisableRealTime` | ุฅููุงู ุงูุญูุงูุฉ ุงูููุฑูุฉ |
| `GetQuarantineList` | ูุงุฆูุฉ ุงููููุงุช ุงููุญุฌูุฑุฉ |
| `RestoreFromQuarantine` | ุงุณุชุนุงุฏุฉ ููู ูู ุงูุญุฌุฑ |
| `DeleteFromQuarantine` | ุญุฐู ููู ูู ุงูุญุฌุฑ ููุงุฆูุงู |
| `GetHistory` | ุณุฌู ุงูุชูุฏูุฏุงุช ุงูููุชุดูุฉ |

---

## ุตูุญุงุช ูุงุฌูุฉ ุงููุณุชุฎุฏู

| # | ุงูุตูุญุฉ | ุงูุฃููููุฉ | ุงููุตู |
|---|--------|----------|-------|
| 0 | ููุญุฉ ุงูููุงุฏุฉ | ๐ | ุฅุญุตุงุฆูุงุช ุนุงูุฉุ ุญุงูุฉ ุงูุญูุงูุฉุ ุขุฎุฑ ุงูุชูุฏูุฏุงุช |
| 1 | ูุญุต ุงููููุงุช | ๐ | ูุญุต ุณุฑูุน/ูุงูู/ูุฎุตุต ูุน ุดุฑูุท ุชูุฏู |
| 2 | ุงูุนูููุงุช | โ๏ธ | ูุญุต ุงูุนูููุงุช ุงูุฌุงุฑูุฉ ูู ุงูุฐุงูุฑุฉ |
| 3 | ุงูุญุฌุฑ ุงูุตุญู | ๐ | ุนุฑุถ/ุงุณุชุนุงุฏุฉ/ุญุฐู ุงููููุงุช ุงููุญุฌูุฑุฉ |
| 4 | ุณุฌู ุงูุชูุฏูุฏุงุช | ๐ | ุฌููุน ุงูุชูุฏูุฏุงุช ุงูููุชุดูุฉ ูุน ููุชุฑุฉ ูุชูุงุตูู ุงููุญุฑูุงุช |
| 5 | ุงูุฅุนุฏุงุฏุงุช | โก | ุฅุนุฏุงุฏุงุช ุงูุญูุงูุฉุ VirusTotal APIุ MLุ ุงูุงุณุชุซูุงุกุงุช |

---

## ููููุฉ ุงูุจูุงุก ูุงูุชุดุบูู

### ุงููุชุทูุจุงุช

- .NET 8 SDK
- Windows 10/11 (ูู DPAPI ู Windows Service)
- Visual Studio 2022 ุฃู ุฃุญุฏุซ

### ุงูุจูุงุก

```bash
dotnet build ShieldAI.sln
```

### ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช

```bash
dotnet test ShieldAI.Tests/ShieldAI.Tests.csproj
```

### ุชุดุบูู ูุงุฌูุฉ ุงููุณุชุฎุฏู

```bash
dotnet run --project ShieldAI.UI
```

### ุชุซุจูุช ุงูุฎุฏูุฉ

```bash
sc create ShieldAI binPath="path\to\ShieldAI.Service.exe"
sc start ShieldAI
```

---

## ุงููููุงุช ุงููุถุงูุฉ ุญุฏูุซุงู (โญ)

### ShieldAI.Core (14 ููู ุฌุฏูุฏ)
- `Detection/ThreatScoring/` โ 8 ูููุงุช (ูุธุงู ุงูุชูููู ุงููุชุนุฏุฏ)
- `Monitoring/Pipeline/` โ 3 ูููุงุช (Pipeline ุงููุฑุงูุจุฉ)
- `Monitoring/Quarantine/` โ 3 ูููุงุช (ุงูุญุฌุฑ ุงูุขูู)

### ShieldAI.Service (4 ูููุงุช ุฌุฏูุฏุฉ)
- `Ipc/PipeContracts.cs`, `Ipc/PipeServer.cs`
- `Workers/RealtimeWorker.cs`, `Workers/ScanWorkerService.cs`

### ShieldAI.UI (5 ูููุงุช ุฌุฏูุฏุฉ)
- `Services/PipeClient.cs`
- `Models/ThreatRecord.cs`
- `ViewModels/HistoryViewModel.cs`
- `Views/HistoryView.xaml`, `Views/HistoryView.xaml.cs`

### ShieldAI.Tests (4 ูููุงุช ุฌุฏูุฏุฉ)
- `ThreatAggregatorTests.cs` (17 ุงุฎุชุจุงุฑ)
- `QuarantineStoreTests.cs` (14 ุงุฎุชุจุงุฑ)
- `EventCoalescerTests.cs` (9 ุงุฎุชุจุงุฑุงุช)
- `FeatureExtractionTests.cs` (8 ุงุฎุชุจุงุฑุงุช)

---

## ุงูุชุฑุฎูุต

ูุดุฑูุน ุฎุงุต โ ุฌููุน ุงูุญููู ูุญููุธุฉ.

---

> **ShieldAI** โ ุญูุงูุฉ ุฐููุฉุ ูุดู ูุชุนุฏุฏ ุงููุญุฑูุงุชุ ุฃูุงู ุจูุง ุชูุงุฒูุงุช. ๐ก๏ธ
