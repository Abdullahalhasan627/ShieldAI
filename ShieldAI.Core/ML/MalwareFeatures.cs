using Microsoft.ML.Data;

namespace ShieldAI.Core.ML;

/// <summary>
/// بيانات الإدخال لنموذج ML.NET
/// تحتوي على الخصائص المستخرجة من ملف PE
/// </summary>
public class MalwareFeatures
{
    /// <summary>
    /// حجم الملف بالكيلوبايت
    /// </summary>
    [LoadColumn(0)]
    public float FileSize { get; set; }

    /// <summary>
    /// عدد الـ Sections
    /// </summary>
    [LoadColumn(1)]
    public float SectionCount { get; set; }

    /// <summary>
    /// معدل الإنتروبيا (0-8)
    /// </summary>
    [LoadColumn(2)]
    public float Entropy { get; set; }

    /// <summary>
    /// عدد الـ DLLs المستوردة
    /// </summary>
    [LoadColumn(3)]
    public float ImportedDllCount { get; set; }

    /// <summary>
    /// عدد الـ DLLs المشبوهة
    /// </summary>
    [LoadColumn(4)]
    public float SuspiciousDllCount { get; set; }

    /// <summary>
    /// عدد الـ APIs الخطيرة
    /// </summary>
    [LoadColumn(5)]
    public float DangerousApiCount { get; set; }

    /// <summary>
    /// هل يحتوي على توقيع رقمي (1 = نعم، 0 = لا)
    /// </summary>
    [LoadColumn(6)]
    public float HasDigitalSignature { get; set; }

    /// <summary>
    /// هل هو ملف DLL (1) أو EXE (0)
    /// </summary>
    [LoadColumn(7)]
    public float IsDll { get; set; }

    /// <summary>
    /// هل المعمارية 64-bit (1 = نعم، 0 = لا)
    /// </summary>
    [LoadColumn(8)]
    public float Is64Bit { get; set; }

    /// <summary>
    /// نسبة حجم الكود إلى الحجم الكلي
    /// </summary>
    [LoadColumn(9)]
    public float CodeRatio { get; set; }

    /// <summary>
    /// التصنيف (0 = آمن، 1 = خبيث)
    /// </summary>
    [LoadColumn(10), ColumnName("Label")]
    public bool IsMalware { get; set; }
}

/// <summary>
/// نتيجة التنبؤ من نموذج ML.NET
/// </summary>
public class MalwarePrediction
{
    /// <summary>
    /// التنبؤ (true = خبيث، false = آمن)
    /// </summary>
    [ColumnName("PredictedLabel")]
    public bool IsMalware { get; set; }

    /// <summary>
    /// درجة الثقة (0-1)
    /// </summary>
    public float Probability { get; set; }

    /// <summary>
    /// الدرجة الخام
    /// </summary>
    public float Score { get; set; }
}
